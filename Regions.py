import numpy as np
import matplotlib.pyplot as plt

def point_in_poly(x,y,poly):
    """docstring for point_in_poly
    input: x : x of point to test
	   y : y of point to test 

	   poly : polygon list of coordinates (lists of points [[x,y]...] or of tuples [(x,y)..] )

    output: True/False

    Determine if a point is inside a given polygon or not
    Polygon is a list of (x,y) pairs. This function
    returns True or False.  The algorithm is called
    the "Ray Casting Method".
""" 

    n = len(poly)
    inside = False

    p1x,p1y = poly[0]
    for i in range(n+1):
        p2x,p2y = poly[i % n]
        if y > min(p1y,p2y):
            if y <= max(p1y,p2y):
                if x <= max(p1x,p2x):
                    if p1y != p2y:
                        xints = (y-p1y)*(p2x-p1x)/(p2y-p1y)+p1x
                    if p1x == p2x or x <= xints:
                        inside = not inside
        p1x,p1y = p2x,p2y

    return inside

######### Regions
"""Here the relevant regions are expressed in dictionaries. india2 is the large region which is initially used in processing data of GFAS, GFED etc. from netCDF files to json files. But it is a large region (can be visualised in Google maps) so coordinates of the individual provinces are also defined (bihar, up, haryana, punjab_ind, punjab_pak). igp3 is a larger region containing punjab_ind, haryana, up, bihar."""

india2 = {'name':'india2', 'latmax':37, 'latmin':13, 'longmax':94, 'longmin':62}
bihar = {'name':'Bihar', 'type':'Polygon', 'coordinates':[(83.8481026, 27.343927), (84.6101316, 27.3339042), (84.6719304, 27.0284977), (86.8041113, 26.4154535), (87.0787695, 26.5531209), (87.3424414, 26.3859319), (88.1224707, 26.5432929), (88.2762793, 26.3564028), (87.7928808, 25.9224457), (88.0895117, 25.486885), (87.765415, 25.3926349), (87.9137304, 25.1740891), (87.5307472, 25.3064617), (87.0889226, 24.6257456), (86.6023512, 24.555505), (86.4639466, 24.3755074), (86.277179, 24.4555381), (86.3046448, 24.5854796), (86.1178772, 24.6229377), (86.0409729, 24.7726578), (85.9607053, 24.7362119), (85.7437254, 24.8209982), (85.680554, 24.6014325), (84.9691892, 24.3789791), (84.889519, 24.3925791), (84.8043749, 24.5100908), (84.5071355, 24.2857242), (84.2938549, 24.4457329), (84.2993481, 24.5494551), (84.1139538, 24.4832327), (84.0109556, 24.6381133), (83.9381711, 24.5494551), (83.5130931, 24.5196887), (83.5295726, 24.6245982), (83.3263255, 24.95374), (83.3312274, 25.2054313), (83.8343855, 25.4375631), (84.1008039, 25.7199859), (84.2738386, 25.616013), (84.3809553, 25.7818315), (84.5389544, 25.6602852), (84.6735369, 25.7481403), (84.013766, 26.1752563), (84.1898973, 26.2977207), (83.8877733, 26.4527431), (83.8822801, 26.5314049), (84.060808, 26.5486049), (84.0745409, 26.6296563), (84.4013842, 26.6222903), (84.2310961, 26.7420499), (84.2283495, 26.8597239), (84.1706713, 26.8205128), (84.060808, 26.8891232), (84.0031298, 27.1044848), (83.9317186, 27.0800326), (83.9729174, 27.1851388)]}
up = {'name':'Uttar Pradesh', 'type':'Polygon', 'coordinates':[(77.5795931, 30.3837306), (77.9482976, 30.219867), (77.7026643, 29.851088), (78.0761995, 29.5934826), (78.2778874, 29.7822091), (78.9111604, 29.4405162), (78.7793245, 29.3064811), (80.0976839, 28.8263495), (83.8974115, 27.3650966), (84.3917962, 26.6407449), (83.9413568, 26.4441769), (84.6637079, 25.7337628), (83.4231229, 25.1704472), (83.390164, 24.1119659), (82.9800359, 23.854391), (82.5991483, 24.6722816), (81.1928983, 25.0610237), (80.8706609, 24.9349614), (80.3030058, 25.0311639), (80.2114812, 25.402294), (79.8525663, 25.0809262), (78.5232206, 25.3095716), (78.9846464, 24.4224478), (78.7759061, 24.1721183), (78.1826444, 24.4324507), (78.2815214, 25.3889996), (79.0908757, 26.3315261), (78.2467555, 26.8537773), (77.4827905, 26.7484007), (77.6146265, 27.3403906), (77.296023, 27.5354001), (77.2740503, 27.8078328), (77.5383944, 27.9432742), (77.2278574, 28.9262597), (77.134099, 29.7598643)]}
haryana = {'name':'Haryana', 'type':'Polygon', 'coordinates':[(76.749756, 30.9124196), (77.1419438, 30.7122753), (77.1181674, 30.5541754), (77.5795931, 30.3837306), (77.1785922, 29.8849026), (77.0907015, 29.507939), (77.206058, 28.860506), (76.9533724, 28.8316366), (76.8544955, 28.5795134), (76.8984408, 28.5071309), (77.0907015, 28.5023036), (77.1566195, 28.4057118), (77.3433871, 28.5216114), (77.4889559, 28.3960478), (77.5383944, 27.9432742), (77.1479198, 27.7723826), (76.9831249, 27.6508053), (76.8787547, 27.7091793), (76.9721385, 28.1459865), (76.8238231, 28.2186157), (76.5491649, 27.9617722), (76.4667674, 28.1459865), (76.278783, 28.1753806), (76.3515675, 28.1245248), (76.2980091, 28.1015106), (76.3392078, 28.0324386), (76.1799061, 28.0578914), (76.2169849, 27.8237422), (76.170293, 27.812811), (75.9299671, 27.9220739), (76.066678, 28.1887984), (75.5558137, 28.6236561), (75.3668296, 29.2603478), (74.6170127, 29.3393898), (74.5823077, 29.762381), (74.4532183, 29.7719177), (74.5191363, 29.9434226), (74.9256304, 29.9362824), (75.2195147, 29.7528434), (75.2303227, 29.5339861), (75.4529742, 29.8029056), (75.8362879, 29.7994742), (75.9241785, 29.7160204), (76.1960901, 29.8423663), (76.2263025, 30.1325927), (76.3389124, 30.1230906), (76.4130701, 30.201456), (76.5970911, 30.0755661), (76.6080774, 30.239429), (76.7673792, 30.4314417), (76.8964686, 30.3627397), (76.8961094, 30.6242407), (76.7065952, 30.7376225), (76.8356846, 30.7706671)]}
punjab_ind = {'name':'Punjab', 'type':'Polygon', 'coordinates':[(75.8169499, 32.5270844), (75.6082097, 32.1278951), (76.7794491, 30.8678762), (76.9222172, 30.3526831), (76.3619145, 30.2768102), (76.2520512, 29.8775161), (75.9554203, 29.7154401), (75.4280766, 29.7917439), (75.2303227, 29.5339861), (75.0769346, 29.8918901), (73.8904111, 29.9585413), (73.8957693, 30.3527958), (74.7032644, 31.0753535), (74.4944676, 31.0923999), (74.5439627, 31.7223951)]}
punjab_pak = {'name':'Punjab-Pakistan', 'type':'Polygon', 'coordinates':[(75.3230136, 32.3585666), (74.6858065, 32.5069297), (74.6803134, 32.802922), (74.3397372, 32.7798329), (73.7794345, 32.9874187), (73.6421054, 33.0933301), (73.5322421, 33.9770239), (73.2685702, 33.794618), (73.3784335, 33.7261153), (73.2026523, 33.4653065), (73.0886691, 33.6632731), (72.9019015, 33.5809375), (72.8634494, 33.7478137), (72.7810519, 33.9576618), (72.2646945, 33.9667739), (71.6769259, 33.0691659), (71.1605685, 32.9401781), (71.3345309, 32.4987075), (70.7302829, 31.3330593), (70.2468844, 31.1827945), (69.63165, 29.68621), (69.7085543, 29.2699853), (69.3350192, 28.5390464), (70.2139254, 27.8807173), (70.5435153, 28.0650702), (70.8071872, 27.7155035), (71.90582, 27.9486735), (73.3999606, 29.9576682), (73.9712497, 30.1803082), (73.8957693, 30.3527958), (74.3722506, 30.8711465), (74.5678397, 31.0500182), (74.7032644, 31.0753535), (74.6859427, 31.1306192), (74.5980521, 31.1306192), (74.6076651, 31.0953469), (74.5623465, 31.0835866), (74.5307609, 31.3120638), (74.654357, 31.4304895), (74.578826, 31.5042833), (74.6200248, 31.5526338), (74.4909354, 31.7139902), (74.8850699, 32.0381897), (75.1762076, 32.0684521), (75.3767081, 32.2265846)]}
igp3 = {'name':'IGP', 'type': 'Polygon', 'coordinates': [(32.52708, 75.81694), (32.12789, 75.6082), (30.21986, 77.94829), (29.64862, 77.81646), (29.7822, 78.27788), (28.72787, 80.09063), (27.37049, 83.29863), (27.3217, 84.58403), (27.02849, 84.67193), (26.45945, 88.11065), (25.76892, 87.93486), (24.62574, 87.08892), (24.42584, 86.41875), (24.82532, 85.72661), (24.28572, 84.50713), (24.5758, 83.51836), (23.85439, 82.98003), (25.1937, 81.57378), (24.93496, 80.87066), (25.40229, 80.21148), (25.14399, 79.85991), (25.20364, 78.56353), (25.46182, 78.40972), (26.33152, 79.09087), (26.76395, 78.12407), (26.8718, 77.40996), (28.0901, 76.91558), (27.84752, 76.15752), (29.2564, 75.2896), (29.40175, 74.56202), (29.9187, 74.51644), (29.87107, 73.85176), (30.0947, 73.77486), (31.09239, 74.49446), (31.12061, 74.65926), (31.83271, 74.56038)]}
igp3['coordinates'] = [tuple(reversed(i)) for i in igp3['coordinates']]
west_bengal = {'name':'West Bengal', 'type':'Polygon', 'coordinates':(87.5131275, 21.6076962), (86.7145554, 22.1619147), (86.8628708, 22.3144519), (86.4234177, 22.8166385), (86.4948288, 22.9785684), (85.863115, 23.1958563), (86.1048142, 23.5740016), (86.3135544, 23.4531126), (86.7969529, 23.7148982), (86.769487, 23.8556428), (87.236406, 23.8455947), (87.2528855, 24.0363756), (87.4396531, 24.006271), (87.6978318, 24.2018243), (87.8241745, 24.7767051), (87.9450242, 24.9312214), (87.7527634, 25.1402572), (87.873613, 25.2247655), (87.765415, 25.3926349), (88.1006075, 25.5241165), (87.7928808, 25.9224457), (88.2762793, 26.3564028), (88.1224707, 26.5432929), (88.1720186, 26.8720682), (87.9962374, 27.1265806), (88.7817598, 27.1656851), (89.1278291, 26.8132529), (89.85842, 26.7495019), (89.7079927, 26.1809651), (89.5541841, 25.9638615), (89.1312104, 26.1908239), (88.9609223, 26.4665298), (89.0378266, 26.235178), (88.4061128, 26.604136), (88.3676606, 26.486198), (88.5159761, 26.3829028), (88.0984956, 25.9144638), (88.1644136, 25.8007704), (88.9609223, 25.2157646), (88.4500581, 25.1710289), (88.3182221, 24.8923053), (88.1589204, 24.9271804), (88.0215913, 24.6628819), (88.7357026, 24.302937), (88.7411958, 23.9068197), (88.5928804, 23.8465431), (88.8071138, 23.4742196), (88.7082368, 23.2573846), (88.9883882, 23.2170042), (88.8730317, 23.0654689), (89.1202241, 21.637913)]}


#Adding filenames to polygon dictionaries
bihar['filename']='bihar'
haryana['filename']='haryana'
up['filename']='up'
punjab_pak['filename']='punjab_pak'
punjab_ind['filename']='punjab_ind'
igp3['filename']='igp'
west_bengal['filename']='wb'


######### Checking if region is correct
#x = np.arange(60,90,0.1)
#y = np.arange(10, 50,0.1)
#for i in range(len(x)):
#    for j in range(len(y)):
#        if point_in_poly(x[i], y[j], igp3['coordinates']):
#            plt.scatter(x[i], y[j])
#plt.show()

